# CSIP

This repository contains the implementation of CSIP and can be used to reproduce the results in (link). The implementation is based on an open source implementation of OpenAI's CLIP (OpenAI link). 

## Abstract
Advanced AI developments have been transforming the biomedical field. The emergence of multi-modal biomedical data, such as imaging, sequencing and other omics data, further enables training AI models for complex analytical tasks. However, such data analysis remains challenging due to the difficulty of integrating information from different modalities. In this paper, we aim to address this challenge by proposing a methodology to integrate both image and molecular structure data. We present a Contrastive Structure-to-Image Pretraning (CSIP) framework, which leverages a self-supervised Graph Neural Network (GNN) to encode molecules and images into a joint feature representation space. This direct mapping between the two modalities enables a wide variety of applications, including image profiling and clustering of molecules based on their effects on cell morphology. Image profiles generated by CSIP archived an AUC of $0.708$ when predicting biological activities, outperforming the state-of-the-art fully supervised methodologies. Further, CSIP improved the accuracy of image-molecule matching by $30$-folds from the random baseline after being trained on a small dataset, which demonstrated data efficiency.

## Data
The dataset we used can be found at [here](https://gigadb.org/dataset/100200), and the scripts for downloading the dataset can be found at [here](https://github.com/gigascience/paper-bray2017/tree/master?tab=readme-ov-file). 

## Setup


## Usage
python train.py \ 
--load_dir "<path to dataset>" \
--load_dir_label “D:\Cell painting” \
--save_dir "output" \
--device "cpu" \
--use_wandb 0 \
--debug 0 \
--learnable_tau 1 \
--lr 0.001
--loss "standard" 

## Retrieval task
We provide a [Jupyter notebook](https://github.com/LeoL18/CSIP/blob/master/retrieval.ipynb) for a demonstration of molecule retrieval with CSIP. 
